---
description: Start a new feature or bug fix by creating a git branch with impact analysis. Use when beginning any new development work.
globs: 
alwaysApply: false
---

# Start Feature / Fix

1. **Analyze Request:**
   - Is it a **Bug Fix**? -> Prefix `fix/`
   - Is it a **New Feature**? -> Prefix `feat/`
   - Is it **Documentation**? -> Prefix `docs/`

2. **Impact Analysis (Mandatory BEFORE any code is written):**

   This step determines whether the fix is **surgical** (only changes one place) or **systemic** (requires coordinated changes across multiple files).

   **For Bug Fixes — answer ALL of these:**
   - [ ] What is the **root cause**? (Not just the symptom — dig one level deeper)
   - [ ] Which **files/functions** will I change?
   - [ ] What **other code calls** those functions? (Search with Grep tool)
   - [ ] What **database entities or shared types** does this touch? Will a schema change cascade?
   - [ ] Is this a **temporary workaround** or a **permanent root-cause fix**?
     - If temporary: state explicitly *"This is a workaround. The permanent fix requires: [X]."* Log it in `PROJECT_STATUS.md` backlog.
     - If permanent: state explicitly *"Root cause eliminated. No further action needed."*
   - [ ] Are there **other modules with the same bug?** (e.g., if pagination is broken in Module A, is it also broken in Module B which uses the same pattern?)

   **For New Features — answer ALL of these:**
   - [ ] Which **existing modules** does this feature touch or extend?
   - [ ] Does it change any **shared service, entity, or type** that other modules depend on?
   - [ ] Does it require a **database migration**? If yes, identify all entities affected.
   - [ ] Does it change any **API contract** (request/response shape)? If yes, identify all frontend callers.

   **Document your impact analysis as a brief note before starting.** Example:
   > "Fixing `sync.scheduler.ts`. Root cause: stale repeatable job key in Redis after settings change.
   > Callers: `sync.controller.ts` (manual trigger), `sync.module.ts` (registers on startup).
   > Related risk: `sync.processor.ts` shares the same queue name — verify it still binds correctly after fix.
   > Verdict: Permanent fix (EventEmitter teardown + rebuild pattern)."

3. **Check Current Status:**
   - Ensure `git status` is clean.
   - `git checkout main`
   - `git pull origin main`

4. **Create Branch:**
   - Generate a short, descriptive name (e.g., `feat/add-user-profile`, `fix/login-error`).
   - `git checkout -b <branch-name>`

5. **Update Context:**
   - Update `PROJECT_STATUS.md` -> Set `Active Task` to the new feature/fix name.
   - Inform User: "Impact analysis complete. Starting work on branch `<branch-name>`."
